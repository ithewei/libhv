[English](README.md) | ä¸­æ–‡

# libhv

[![platform](https://img.shields.io/badge/platform-linux%20%7C%20windows%20%7C%20macos-blue)](.github/workflows/CI.yml)
[![CI](https://github.com/ithewei/libhv/workflows/CI/badge.svg?branch=master)](https://github.com/ithewei/libhv/actions/workflows/CI.yml?query=branch%3Amaster)
[![benchmark](https://github.com/ithewei/libhv/workflows/benchmark/badge.svg?branch=master)](https://github.com/ithewei/libhv/actions/workflows/benchmark.yml?query=branch%3Amaster)
<br>
[![release](https://badgen.net/github/release/ithewei/libhv?icon=github)](https://github.com/ithewei/libhv/releases)
[![stars](https://badgen.net/github/stars/ithewei/libhv?icon=github)](https://github.com/ithewei/libhv/stargazers)
[![forks](https://badgen.net/github/forks/ithewei/libhv?icon=github)](https://github.com/ithewei/libhv/network/members)
[![issues](https://badgen.net/github/issues/ithewei/libhv?icon=github)](https://github.com/ithewei/libhv/issues)
[![PRs](https://badgen.net/github/prs/ithewei/libhv?icon=github)](https://github.com/ithewei/libhv/pulls)
[![license](https://badgen.net/github/license/ithewei/libhv?icon=github)](LICENSE)
<br>
[![gitee](https://badgen.net/badge/mirror/gitee/red)](https://gitee.com/libhv/libhv)
[![awesome-c](https://badgen.net/badge/icon/awesome-c/pink?icon=awesome&label&color)](https://github.com/oz123/awesome-c)
[![awesome-cpp](https://badgen.net/badge/icon/awesome-cpp/pink?icon=awesome&label&color)](https://github.com/fffaraz/awesome-cpp)

`libhv`æ˜¯ä¸€ä¸ªç±»ä¼¼äº`libeventã€libevã€libuv`çš„è·¨å¹³å°ç½‘ç»œåº“ï¼Œæä¾›äº†æ›´æ˜“ç”¨çš„æ¥å£å’Œæ›´ä¸°å¯Œçš„åè®®ã€‚

## ğŸ“š ä¸­æ–‡èµ„æ–™

- **libhv QQç¾¤**: `739352073`ï¼Œæ¬¢è¿åŠ ç¾¤äº¤æµ
- **libhv æºç å‰–æ**: <https://hewei.blog.csdn.net/article/details/123295998>
- **libhv æ¥å£æ‰‹å†Œ**: <https://hewei.blog.csdn.net/article/details/103976875>
- **libhv æ•™ç¨‹ç›®å½•**: <https://hewei.blog.csdn.net/article/details/113733758>
- [libhvæ•™ç¨‹01--ä»‹ç»ä¸ä½“éªŒ](https://hewei.blog.csdn.net/article/details/113702536)
- [libhvæ•™ç¨‹02--ç¼–è¯‘ä¸å®‰è£…](https://hewei.blog.csdn.net/article/details/113704737)
- [libhvæ•™ç¨‹03--é“¾åº“ä¸ä½¿ç”¨](https://hewei.blog.csdn.net/article/details/113706378)
- [libhvæ•™ç¨‹04--ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„å‘½ä»¤è¡Œç¨‹åº](https://hewei.blog.csdn.net/article/details/113719503)
- [libhvæ•™ç¨‹05--äº‹ä»¶å¾ªç¯ä»¥åŠå®šæ—¶å™¨çš„ç®€å•ä½¿ç”¨](https://hewei.blog.csdn.net/article/details/113724474)
- [libhvæ•™ç¨‹06--åˆ›å»ºä¸€ä¸ªç®€å•çš„TCPæœåŠ¡ç«¯](https://hewei.blog.csdn.net/article/details/113737580)
- [libhvæ•™ç¨‹07--åˆ›å»ºä¸€ä¸ªç®€å•çš„TCPå®¢æˆ·ç«¯](https://hewei.blog.csdn.net/article/details/113738900)
- [libhvæ•™ç¨‹08--åˆ›å»ºä¸€ä¸ªç®€å•çš„UDPæœåŠ¡ç«¯](https://hewei.blog.csdn.net/article/details/113871498)
- [libhvæ•™ç¨‹09--åˆ›å»ºä¸€ä¸ªç®€å•çš„UDPå®¢æˆ·ç«¯](https://hewei.blog.csdn.net/article/details/113871724)
- [libhvæ•™ç¨‹10--åˆ›å»ºä¸€ä¸ªç®€å•çš„HTTPæœåŠ¡ç«¯](https://hewei.blog.csdn.net/article/details/113982999)
- [libhvæ•™ç¨‹11--åˆ›å»ºä¸€ä¸ªç®€å•çš„HTTPå®¢æˆ·ç«¯](https://hewei.blog.csdn.net/article/details/113984302)
- [libhvæ•™ç¨‹12--åˆ›å»ºä¸€ä¸ªç®€å•çš„WebSocketæœåŠ¡ç«¯](https://hewei.blog.csdn.net/article/details/113985321)
- [libhvæ•™ç¨‹13--åˆ›å»ºä¸€ä¸ªç®€å•çš„WebSocketå®¢æˆ·ç«¯](https://hewei.blog.csdn.net/article/details/113985895)
- [libhvæ•™ç¨‹14--200è¡Œå®ç°ä¸€ä¸ªçº¯Cç‰ˆjsonrpcæ¡†æ¶](https://hewei.blog.csdn.net/article/details/119920540)
- [libhvæ•™ç¨‹15--200è¡Œå®ç°ä¸€ä¸ªC++ç‰ˆprotorpcæ¡†æ¶](https://hewei.blog.csdn.net/article/details/119966701)
- [libhvæ•™ç¨‹16--å¤šçº¿ç¨‹/å¤šè¿›ç¨‹æœåŠ¡ç«¯ç¼–ç¨‹](https://hewei.blog.csdn.net/article/details/120366024)
- [libhvæ•™ç¨‹17--Qtä¸­ä½¿ç”¨libhv](https://hewei.blog.csdn.net/article/details/120699890)
- [libhvæ•™ç¨‹18--åŠ¨æ‰‹å†™ä¸€ä¸ªtinyhttpd](https://hewei.blog.csdn.net/article/details/121706604)
- [libhvæ•™ç¨‹19--MQTTçš„å®ç°ä¸ä½¿ç”¨](https://hewei.blog.csdn.net/article/details/122753665)

## âœ¨ ç‰¹æ€§

- è·¨å¹³å°ï¼ˆLinux, Windows, MacOS, BSD, Solaris, Android, iOSï¼‰
- é«˜æ€§èƒ½äº‹ä»¶å¾ªç¯ï¼ˆç½‘ç»œIOäº‹ä»¶ã€å®šæ—¶å™¨äº‹ä»¶ã€ç©ºé—²äº‹ä»¶ã€è‡ªå®šä¹‰äº‹ä»¶ï¼‰
- TCP/UDPæœåŠ¡ç«¯/å®¢æˆ·ç«¯/ä»£ç†
- TCPæ”¯æŒå¿ƒè·³ã€é‡è¿ã€è½¬å‘ã€å¤šçº¿ç¨‹å®‰å…¨writeå’Œcloseç­‰ç‰¹æ€§
- å†…ç½®å¸¸è§çš„æ‹†åŒ…æ¨¡å¼ï¼ˆå›ºå®šåŒ…é•¿ã€åˆ†ç•Œç¬¦ã€å¤´éƒ¨é•¿åº¦å­—æ®µï¼‰
- å¯é UDPæ”¯æŒ: WITH_KCP
- SSL/TLSåŠ å¯†é€šä¿¡ï¼ˆå¯é€‰WITH_OPENSSLã€WITH_GNUTLSã€WITH_MBEDTLSï¼‰
- HTTPæœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼ˆæ”¯æŒhttps http1/x http2 grpcï¼‰
- HTTPæ”¯æŒé™æ€æ–‡ä»¶æœåŠ¡ã€ç›®å½•æœåŠ¡ã€ä»£ç†æœåŠ¡ã€åŒæ­¥/å¼‚æ­¥APIå¤„ç†å‡½æ•°
- HTTPæ”¯æŒRESTfulé£æ ¼ã€URIè·¯ç”±ã€keep-aliveé•¿è¿æ¥ã€chunkedåˆ†å—ç­‰ç‰¹æ€§
- WebSocketæœåŠ¡ç«¯/å®¢æˆ·ç«¯
- MQTTå®¢æˆ·ç«¯

## âŒ›ï¸ æ„å»º

è§[BUILD.md](BUILD.md)

libhvæä¾›äº†ä»¥ä¸‹æ„å»ºæ–¹å¼:

1ã€é€šè¿‡Makefile:
```shell
./configure
make
sudo make install
```

2ã€é€šè¿‡cmake:
```shell
mkdir build
cd build
cmake ..
cmake --build .
```

3ã€é€šè¿‡vcpkg:
```shell
vcpkg install libhv
```

4ã€é€šè¿‡xmake:
```shell
xrepo install libhv
```

## âš¡ï¸ å¿«é€Ÿå…¥é—¨

### ä½“éªŒ
è¿è¡Œè„šæœ¬`./getting_started.sh`:

```shell
# ä¸‹è½½ç¼–è¯‘
git clone https://github.com/ithewei/libhv.git
cd libhv
./configure
make

# è¿è¡ŒhttpdæœåŠ¡
bin/httpd -h
bin/httpd -d
#bin/httpd -c etc/httpd.conf -s restart -d
ps aux | grep httpd

# æ–‡ä»¶æœåŠ¡
bin/curl -v localhost:8080

# ç›®å½•æœåŠ¡
bin/curl -v localhost:8080/downloads/

# APIæœåŠ¡
bin/curl -v localhost:8080/ping
bin/curl -v localhost:8080/echo -d "hello,world!"
bin/curl -v localhost:8080/query?page_no=1\&page_size=10
bin/curl -v localhost:8080/kv   -H "Content-Type:application/x-www-form-urlencoded" -d 'user=admin&pswd=123456'
bin/curl -v localhost:8080/json -H "Content-Type:application/json" -d '{"user":"admin","pswd":"123456"}'
bin/curl -v localhost:8080/form -F 'user=admin' -F 'pswd=123456'
bin/curl -v localhost:8080/upload -d "@LICENSE"
bin/curl -v localhost:8080/upload -F "file=@LICENSE"

bin/curl -v localhost:8080/test -H "Content-Type:application/x-www-form-urlencoded" -d 'bool=1&int=123&float=3.14&string=hello'
bin/curl -v localhost:8080/test -H "Content-Type:application/json" -d '{"bool":true,"int":123,"float":3.14,"string":"hello"}'
bin/curl -v localhost:8080/test -F 'bool=1' -F 'int=123' -F 'float=3.14' -F 'string=hello'
# RESTful API: /group/:group_name/user/:user_id
bin/curl -v -X DELETE localhost:8080/group/test/user/123

# å‹åŠ›æµ‹è¯•
bin/wrk -c 1000 -d 10 -t 4 http://127.0.0.1:8080/
```

### TCP
#### TCPæœåŠ¡ç«¯
**cç‰ˆæœ¬**: [examples/tcp_echo_server.c](examples/tcp_echo_server.c)

**c++ç‰ˆæœ¬**: [evpp/TcpServer_test.cpp](evpp/TcpServer_test.cpp)
```c++
#include "TcpServer.h"
using namespace hv;

int main() {
    int port = 1234;
    TcpServer srv;
    int listenfd = srv.createsocket(port);
    if (listenfd < 0) {
        return -1;
    }
    printf("server listen on port %d, listenfd=%d ...\n", port, listenfd);
    srv.onConnection = [](const SocketChannelPtr& channel) {
        std::string peeraddr = channel->peeraddr();
        if (channel->isConnected()) {
            printf("%s connected! connfd=%d\n", peeraddr.c_str(), channel->fd());
        } else {
            printf("%s disconnected! connfd=%d\n", peeraddr.c_str(), channel->fd());
        }
    };
    srv.onMessage = [](const SocketChannelPtr& channel, Buffer* buf) {
        // echo
        channel->write(buf);
    };
    srv.setThreadNum(4);
    srv.start();

    // press Enter to stop
    while (getchar() != '\n');
    return 0;
}
```

**æ³¨æ„**:

ä»¥ä¸Šç¤ºä¾‹åªæ˜¯ç®€å•çš„`echo`æœåŠ¡ï¼ŒTCPæ˜¯æµå¼åè®®ï¼Œå®é™…åº”ç”¨ä¸­è¯·åŠ¡å¿…æ·»åŠ è¾¹ç•Œè¿›è¡Œæ‹†åŒ…ã€‚<br>
æ–‡æœ¬åè®®å»ºè®®åŠ ä¸Š`\0`æˆ–è€…`\r\n`åˆ†éš”ç¬¦ï¼Œå¯å‚è€ƒ [examples/jsonrpc](examples/jsonrpc);<br>
äºŒè¿›åˆ¶åè®®å»ºè®®åŠ ä¸Šè‡ªå®šä¹‰åè®®å¤´ï¼Œé€šè¿‡å¤´éƒ¨é•¿åº¦å­—æ®µè¡¨æ˜è´Ÿè½½é•¿åº¦ï¼Œå¯å‚è€ƒ [examples/protorpc](examples/protorpc);<br>
é€šè¿‡`setUnpack`ï¼ˆcæ¥å£å³`hio_set_unpack`ï¼‰è®¾ç½®æ‹†åŒ…è§„åˆ™ï¼Œæ”¯æŒå›ºå®šåŒ…é•¿ã€åˆ†éš”ç¬¦ã€å¤´éƒ¨é•¿åº¦å­—æ®µä¸‰ç§å¸¸è§çš„æ‹†åŒ…æ–¹å¼ï¼Œ<br>
å†…éƒ¨æ ¹æ®æ‹†åŒ…è§„åˆ™å¤„ç†ç²˜åŒ…ä¸åˆ†åŒ…ï¼Œä¿è¯`onMessage`å›è°ƒä¸Šæ¥çš„æ˜¯å®Œæ•´çš„ä¸€åŒ…æ•°æ®ï¼Œå¤§å¤§èŠ‚çœäº†ä¸Šå±‚å¤„ç†ç²˜åŒ…ä¸åˆ†åŒ…çš„æˆæœ¬ã€‚<br>
ä¸æƒ³è‡ªå®šä¹‰åè®®å’Œæ‹†åŒ…ç»„åŒ…çš„å¯ç›´æ¥ä½¿ç”¨ç°æˆçš„`HTTP/WebSocket`åè®®ã€‚<br>
<br>
`channel->write`ï¼ˆcæ¥å£å³`hio_write`ï¼‰æ˜¯éé˜»å¡çš„ï¼ˆäº‹ä»¶å¾ªç¯å¼‚æ­¥ç¼–ç¨‹é‡Œæ‰€æœ‰çš„ä¸€åˆ‡éƒ½è¦æ±‚æ˜¯éé˜»å¡çš„ï¼‰ï¼Œä¸”å¤šçº¿ç¨‹å®‰å…¨çš„ã€‚<br>
å‘é€å¤§æ•°æ®æ—¶åº”è¯¥åšæµæ§ï¼Œé€šè¿‡`onWriteComplete`ç›‘å¬å†™å®Œæˆäº‹ä»¶ï¼Œåœ¨å¯å†™æ—¶å†å‘é€ä¸‹ä¸€å¸§æ•°æ®ã€‚<br>
å…·ä½“ç¤ºä¾‹ä»£ç å¯å‚è€ƒ [examples/tinyhttpd.c](examples/tinyhttpd.c) ä¸­çš„ `http_serve_file`ã€‚<br>
<br>
`channel->close`ï¼ˆcæ¥å£å³`hio_close`) ä¹Ÿæ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™å¯ä»¥è®©ç½‘ç»œIOäº‹ä»¶å¾ªç¯çº¿ç¨‹é‡Œæ¥æ”¶æ•°æ®ã€æ‹†åŒ…ç»„åŒ…ã€ååºåˆ—åŒ–åæ”¾å…¥é˜Ÿåˆ—ï¼Œ<br>
æ¶ˆè´¹è€…çº¿ç¨‹/çº¿ç¨‹æ± ä»é˜Ÿåˆ—é‡Œå–å‡ºæ•°æ®ã€å¤„ç†åå‘é€å“åº”å’Œå…³é—­è¿æ¥ï¼Œå˜å¾—æ›´åŠ ç®€å•ã€‚<br>

#### TCPå®¢æˆ·ç«¯
**cç‰ˆæœ¬**: [examples/tcp_client_test.c](examples/tcp_client_test.c)

**c++ç‰ˆæœ¬**: [evpp/TcpClient_test.cpp](evpp/TcpClient_test.cpp)
```c++
#include <iostream>
#include "TcpClient.h"
using namespace hv;

int main() {
    int port = 1234;
    TcpClient cli;
    int connfd = cli.createsocket(port);
    if (connfd < 0) {
        return -1;
    }
    cli.onConnection = [](const SocketChannelPtr& channel) {
        std::string peeraddr = channel->peeraddr();
        if (channel->isConnected()) {
            printf("connected to %s! connfd=%d\n", peeraddr.c_str(), channel->fd());
        } else {
            printf("disconnected to %s! connfd=%d\n", peeraddr.c_str(), channel->fd());
        }
    };
    cli.onMessage = [](const SocketChannelPtr& channel, Buffer* buf) {
        printf("< %.*s\n", (int)buf->size(), (char*)buf->data());
    };
    cli.start();

    std::string str;
    while (std::getline(std::cin, str)) {
        if (str == "close") {
            cli.closesocket();
        } else if (str == "start") {
            cli.start();
        } else if (str == "stop") {
            cli.stop();
            break;
        } else {
            if (!cli.isConnected()) break;
            cli.send(str);
        }
    }
    return 0;
}
```

### HTTP
#### HTTPæœåŠ¡ç«¯
è§[examples/http_server_test.cpp](examples/http_server_test.cpp)

**golang gin é£æ ¼**
```c++
#include "HttpServer.h"
using namespace hv;

int main() {
    HttpService router;
    router.GET("/ping", [](HttpRequest* req, HttpResponse* resp) {
        return resp->String("pong");
    });

    router.GET("/data", [](HttpRequest* req, HttpResponse* resp) {
        static char data[] = "0123456789";
        return resp->Data(data, 10);
    });

    router.GET("/paths", [&router](HttpRequest* req, HttpResponse* resp) {
        return resp->Json(router.Paths());
    });

    router.GET("/get", [](HttpRequest* req, HttpResponse* resp) {
        resp->json["origin"] = req->client_addr.ip;
        resp->json["url"] = req->url;
        resp->json["args"] = req->query_params;
        resp->json["headers"] = req->headers;
        return 200;
    });

    router.POST("/echo", [](const HttpContextPtr& ctx) {
        return ctx->send(ctx->body(), ctx->type());
    });

    HttpServer server;
    server.registerHttpService(&router);
    server.setPort(8080);
    server.setThreadNum(4);
    server.run();
    return 0;
}
```

**æ³¨æ„**:

ä¸Šé¢ç¤ºä¾‹ç›´æ¥è¿è¡Œåœ¨`main`ä¸»çº¿ç¨‹ï¼Œ`server.run()`ä¼šé˜»å¡å½“å‰çº¿ç¨‹è¿è¡Œï¼Œæ‰€ä»¥`router`å’Œ`server`å¯¹è±¡ä¸ä¼šè¢«ææ„ï¼Œ
å¦‚ä½¿ç”¨`server.start()`å†…éƒ¨ä¼šå¦èµ·çº¿ç¨‹è¿è¡Œï¼Œä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œä½†éœ€è¦æ³¨æ„`router`å’Œ`server`çš„ç”Ÿå‘½å‘¨æœŸï¼Œ
ä¸è¦å®šä¹‰ä¸ºå±€éƒ¨å˜é‡è¢«ææ„äº†ï¼Œå¯å®šä¹‰ä¸ºç±»æˆå‘˜å˜é‡æˆ–è€…å…¨å±€å˜é‡ï¼Œä¸‹é¢çš„`WebSocket`æœåŠ¡åŒç†ã€‚

#### HTTPå®¢æˆ·ç«¯
è§[examples/http_client_test.cpp](examples/http_client_test.cpp)

**python requests é£æ ¼**
```c++
#include "requests.h"

int main() {
    auto resp = requests::get("http://www.example.com");
    if (resp == NULL) {
        printf("request failed!\n");
    } else {
        printf("%s\n", resp->body.c_str());
    }

    resp = requests::post("127.0.0.1:8080/echo", "hello,world!");
    if (resp == NULL) {
        printf("request failed!\n");
    } else {
        printf("%s\n", resp->body.c_str());
    }

    return 0;
}
```

### WebSocket
#### WebSocketæœåŠ¡ç«¯
è§[examples/websocket_server_test.cpp](examples/websocket_server_test.cpp)
```c++
#include "WebSocketServer.h"
using namespace hv;

int main(int argc, char** argv) {
    WebSocketService ws;
    ws.onopen = [](const WebSocketChannelPtr& channel, const HttpRequestPtr& req) {
        printf("onopen: GET %s\n", req->Path().c_str());
    };
    ws.onmessage = [](const WebSocketChannelPtr& channel, const std::string& msg) {
        printf("onmessage: %.*s\n", (int)msg.size(), msg.data());
    };
    ws.onclose = [](const WebSocketChannelPtr& channel) {
        printf("onclose\n");
    };

    WebSocketServer server;
    server.registerWebSocketService(&ws);
    server.setPort(9999);
    server.setThreadNum(4);
    server.run();
    return 0;
}
```

#### WebSocketå®¢æˆ·ç«¯
è§[examples/websocket_client_test.cpp](examples/websocket_client_test.cpp)
```c++
#include "WebSocketClient.h"
using namespace hv;

int main(int argc, char** argv) {
    WebSocketClient ws;
    ws.onopen = []() {
        printf("onopen\n");
    };
    ws.onmessage = [](const std::string& msg) {
        printf("onmessage: %.*s\n", (int)msg.size(), msg.data());
    };
    ws.onclose = []() {
        printf("onclose\n");
    };

    // reconnect: 1,2,4,8,10,10,10...
    reconn_setting_t reconn;
    reconn_setting_init(&reconn);
    reconn.min_delay = 1000;
    reconn.max_delay = 10000;
    reconn.delay_policy = 2;
    ws.setReconnect(&reconn);

    ws.open("ws://127.0.0.1:9999/test");

    std::string str;
    while (std::getline(std::cin, str)) {
        if (!ws.isConnected()) break;
        if (str == "quit") {
            ws.close();
            break;
        }
        ws.send(str);
    }

    return 0;
}
```

## ğŸ­ æ›´å¤šç¤ºä¾‹

### cç‰ˆæœ¬
- äº‹ä»¶å¾ªç¯:     [examples/hloop_test.c](examples/hloop_test.c)
- å®šæ—¶å™¨:       [examples/htimer_test.c](examples/htimer_test.c)
- TCPå›æ˜¾æœåŠ¡:  [examples/tcp_echo_server.c](examples/tcp_echo_server.c)
- TCPèŠå¤©æœåŠ¡:  [examples/tcp_chat_server.c](examples/tcp_chat_server.c)
- TCPä»£ç†æœåŠ¡:  [examples/tcp_proxy_server.c](examples/tcp_proxy_server.c)
- UDPå›æ˜¾æœåŠ¡:  [examples/udp_echo_server.c](examples/udp_echo_server.c)
- UDPä»£ç†æœåŠ¡:  [examples/udp_proxy_server.c](examples/udp_proxy_server.c)
- SOCKS5ä»£ç†æœåŠ¡: [examples/socks5_proxy_server.c](examples/socks5_proxy_server.c)
- HTTPæœåŠ¡:     [examples/tinyhttpd.c](examples/tinyhttpd.c)
- HTTPä»£ç†æœåŠ¡: [examples/tinyproxyd.c](examples/tinyproxyd.c)
- jsonRPCç¤ºä¾‹:  [examples/jsonrpc](examples/jsonrpc)
- MQTTç¤ºä¾‹:     [examples/mqtt](examples/mqtt)
- å¤šacceptè¿›ç¨‹æ¨¡å¼: [examples/multi-thread/multi-acceptor-processes.c](examples/multi-thread/multi-acceptor-processes.c)
- å¤šacceptçº¿ç¨‹æ¨¡å¼: [examples/multi-thread/multi-acceptor-threads.c](examples/multi-thread/multi-acceptor-threads.c)
- ä¸€ä¸ªacceptçº¿ç¨‹+å¤šworkerçº¿ç¨‹: [examples/multi-thread/one-acceptor-multi-workers.c](examples/multi-thread/one-acceptor-multi-workers.c)

### c++ç‰ˆæœ¬
- äº‹ä»¶å¾ªç¯: [evpp/EventLoop_test.cpp](evpp/EventLoop_test.cpp)
- äº‹ä»¶å¾ªç¯çº¿ç¨‹: [evpp/EventLoopThread_test.cpp](evpp/EventLoopThread_test.cpp)
- äº‹ä»¶å¾ªç¯çº¿ç¨‹æ± : [evpp/EventLoopThreadPool_test.cpp](evpp/EventLoopThreadPool_test.cpp)
- å®šæ—¶å™¨:    [evpp/TimerThread_test.cpp](evpp/TimerThread_test.cpp)
- TCPæœåŠ¡ç«¯: [evpp/TcpServer_test.cpp](evpp/TcpServer_test.cpp)
- TCPå®¢æˆ·ç«¯: [evpp/TcpClient_test.cpp](evpp/TcpClient_test.cpp)
- UDPæœåŠ¡ç«¯: [evpp/UdpServer_test.cpp](evpp/UdpServer_test.cpp)
- UDPå®¢æˆ·ç«¯: [evpp/UdpClient_test.cpp](evpp/UdpClient_test.cpp)
- HTTPæœåŠ¡ç«¯: [examples/http_server_test.cpp](examples/http_server_test.cpp)
- HTTPå®¢æˆ·ç«¯: [examples/http_client_test.cpp](examples/http_client_test.cpp)
- WebSocketæœåŠ¡ç«¯: [examples/websocket_server_test.cpp](examples/websocket_server_test.cpp)
- WebSocketå®¢æˆ·ç«¯: [examples/websocket_client_test.cpp](examples/websocket_client_test.cpp)
- protobufRPCç¤ºä¾‹: [examples/protorpc](examples/protorpc)
- Qtä¸­ä½¿ç”¨libhvç¤ºä¾‹: [hv-projects/QtDemo](https://github.com/hv-projects/QtDemo)

### æ¨¡æ‹Ÿå®ç°è‘—åçš„å‘½ä»¤è¡Œå·¥å…·
- ç½‘ç»œè¿æ¥å·¥å…·: [examples/nc](examples/nc.c)
- ç½‘ç»œæ‰«æå·¥å…·: [examples/nmap](examples/nmap)
- HTTPæœåŠ¡ç¨‹åº: [examples/httpd](examples/httpd)
- HTTPå‹æµ‹å·¥å…·: [examples/wrk](examples/wrk.cpp)
- URLè¯·æ±‚å·¥å…·:  [examples/curl](examples/curl.cpp)
- æ–‡ä»¶ä¸‹è½½å·¥å…·: [examples/wget](examples/wget.cpp)
- æœåŠ¡æ³¨å†Œä¸å‘ç°: [examples/consul](examples/consul)

## ğŸ¥‡ æ€§èƒ½æµ‹è¯•

### TCPå›æ˜¾æœåŠ¡pingpongæµ‹è¯•
```shell
cd echo-servers
./build.sh
./benchmark.sh
```

**ååé‡**:
```shell
libevent running on port 2001
libev running on port 2002
libuv running on port 2003
libhv running on port 2004
asio running on port 2005
poco running on port 2006

==============2001=====================================
[127.0.0.1:2001] 4 threads 1000 connections run 10s
total readcount=1616761 readbytes=1655563264
throughput = 157 MB/s

==============2002=====================================
[127.0.0.1:2002] 4 threads 1000 connections run 10s
total readcount=2153171 readbytes=2204847104
throughput = 210 MB/s

==============2003=====================================
[127.0.0.1:2003] 4 threads 1000 connections run 10s
total readcount=1599727 readbytes=1638120448
throughput = 156 MB/s

==============2004=====================================
[127.0.0.1:2004] 4 threads 1000 connections run 10s
total readcount=2202271 readbytes=2255125504
throughput = 215 MB/s

==============2005=====================================
[127.0.0.1:2005] 4 threads 1000 connections run 10s
total readcount=1354230 readbytes=1386731520
throughput = 132 MB/s

==============2006=====================================
[127.0.0.1:2006] 4 threads 1000 connections run 10s
total readcount=1699652 readbytes=1740443648
throughput = 165 MB/s
```

### TCPä»£ç†æœåŠ¡å‹æµ‹

```shell
# sudo apt install iperf
iperf -s -p 5001 > /dev/null &
bin/tcp_proxy_server 1212 127.0.0.1:5001 &
iperf -c 127.0.0.1 -p 5001 -l 8K
iperf -c 127.0.0.1 -p 1212 -l 8K
```

**å¸¦å®½**:
```shell
------------------------------------------------------------
[  3] local 127.0.0.1 port 52560 connected with 127.0.0.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.0 sec  20.8 GBytes  17.9 Gbits/sec

------------------------------------------------------------
[  3] local 127.0.0.1 port 48142 connected with 127.0.0.1 port 1212
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.0 sec  11.9 GBytes  10.2 Gbits/sec
```

### HTTPå‹æµ‹
```shell
# sudo apt install wrk
wrk -c 100 -t 4 -d 10s http://127.0.0.1:8080/

# sudo apt install apache2-utils
ab -c 100 -n 100000 http://127.0.0.1:8080/
```

**libhv(port:8080) vs nginx(port:80)**

![libhv-vs-nginx.png](html/downloads/libhv-vs-nginx.png)

ä»¥ä¸Šæµ‹è¯•ç»“æœå¯ä»¥åœ¨ [Github Actions](https://github.com/ithewei/libhv/actions/workflows/benchmark.yml) ä¸­æŸ¥çœ‹ã€‚

## ğŸ’ ç”¨æˆ·æ¡ˆä¾‹

å¦‚æœæ‚¨åœ¨ä½¿ç”¨`libhv`ï¼Œæ¬¢è¿é€šè¿‡PRå°†ä¿¡æ¯æäº¤è‡³æ­¤åˆ—è¡¨ï¼Œè®©æ›´å¤šçš„ç”¨æˆ·äº†è§£`libhv`çš„å®é™…ä½¿ç”¨åœºæ™¯ï¼Œä»¥å»ºç«‹æ›´å¥½çš„ç½‘ç»œç”Ÿæ€ã€‚

| ç”¨æˆ· (å…¬å¸å/é¡¹ç›®å/ä¸ªäººè”ç³»æ–¹å¼) | æ¡ˆä¾‹ (é¡¹ç›®ç®€ä»‹/ä¸šåŠ¡åœºæ™¯) |
| :--- | :--- |
| [é˜…é¢ç§‘æŠ€](https://www.readsense.cn) | [çŒæˆ·AIoTå¹³å°](https://orionweb.readsense.cn)è®¾å¤‡ç®¡ç†ã€äººè„¸æ£€æµ‹HTTPæœåŠ¡ã€äººè„¸æœç´¢HTTPæœåŠ¡ |
| [socks5-libhv](https://gitee.com/billykang/socks5-libhv) | socks5ä»£ç† |
| [hvloop](https://github.com/xiispace/hvloop) | ç±»ä¼¼[uvloop](https://github.com/MagicStack/uvloop)çš„pythonå¼‚æ­¥IOäº‹ä»¶å¾ªç¯ |
| [tsproxyd-android](https://github.com/Haiwen-GitHub/tsproxyd-android) | ä¸€ä¸ªåŸºäºlibhvå®ç°çš„androidç«¯webä»£ç†æœåŠ¡ |
| [ç„èˆŸæ™ºç»´](https://zjzwxw.com) | C100Kè®¾å¤‡è¿æ¥ç½‘å…³æœåŠ¡ |

